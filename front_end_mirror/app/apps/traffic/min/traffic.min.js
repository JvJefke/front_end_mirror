!function(){angular.module("mirrorApp").controller("trafficCtrl",["$scope","$rootScope","trafficService","styleLib","uiGmapGoogleMapApi","$sce",function(e,t,o,r,n,a){e.mapURL,e.refresh,e.mapURL=a.trustAsResourceUrl("https://www.google.com/maps/embed/v1/directions?origin="+e.app.Data.from+"&destination="+e.app.Data.to+"&key=AIzaSyBa0fvSoqhnkwmyNYlh5eYIULzTv-FlVHQ");var i=function(){e.refresh=!0};i();setInterval(i,3e5)}])}(),function(){angular.module("mirrorApp").directive("myRefreshable",[function(){return{restrict:"A",scope:{refresh:"=myRefreshable"},link:function(e,t){var o=function(){t.attr("src",t.attr("src")),console.log("refresh")};e.$watch("refresh",function(t,r){e.refresh&&(e.refresh=!1,o())})}}}])}(),function(){angular.module("mirrorApp").factory("trafficService",["confService","mainFormatService","dataService",function(e,t,o){function r(e,t,o,r,n){var i=new google.maps.Geocoder;i.geocode({address:t},function(t,o){a.pointCallback(1,t,o,e,r,n)}),i.geocode({address:o},function(t,o){a.pointCallback(2,t,o,e,r,n)})}var n={getTrafficInfo:r},a={};return a.getDirections=function(e,t,r,n,i){o.getData("https://api.tomtom.com/routing/1/calculateRoute/"+e[0]+","+e[1]+":"+t[0]+","+t[1]+"/json?key=nrqqnw5ac2wx64xawpjg3r34&routeType=fastest&traffic=true&departAt=now&computeBestOrder=true",function(e){a.getDuration(e,r,n)},i)},a.pointCallback=function(e,t,o,r,n,i){var c=t[0].geometry.location;switch(e){case 1:a.fromPoint=[c.k,c.B],a.toPoint&&a.getDirections(a.fromPoint,a.toPoint,r,n,i);break;case 2:a.toPoint=[c.k,c.B],a.fromPoint&&a.getDirections(a.fromPoint,a.toPoint,r,n,i)}},a.pointsToPolyline=function(e){var t=[];for(var o in e)t.push(new google.maps.LatLng(e[o].latitude,e[o].longitude));return t},a.getDuration=function(e,o,r){var n={};n.duration={sec:e.routes[0].summary.travelTimeInSeconds,formatted:t.formatTime(e.routes[0].summary.travelTimeInSeconds)},n.delay={sec:e.routes[0].summary.trafficDelayInSeconds,formatted:t.formatTime(e.routes[0].summary.trafficDelayInSeconds)},n.length={meters:e.routes[0].summary.lengthInMeters,formatted:null},n.points=e.routes[0].legs[0].points,r(o,n)},n}])}();