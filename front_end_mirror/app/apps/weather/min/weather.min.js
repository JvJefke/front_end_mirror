!function(){angular.module("mirrorApp").controller("weatherCtrl",["$scope","weatherService",function(a,e){a.showAll=!0,a.weatherData=[],a.curr,a.showNow=!1,a.showDays=!1,a.numberOfItems=0,a.lineLength=0;const t=108e5,n=6e4;var r=function(e){a.weatherData=e,(1!=a.app.Data.ShowToday||a.curr&&a.curr.weather)&&(a.showDays=!0,2==a.app.Data.ShowToday&&(a.showNow=!1)),setTimeout(c,t)},o=function(e){a.curr=e,(2!=a.app.Data.ShowToday||a.weatherData&&a.weatherData.list)&&(a.showNow=!0,1==a.app.Data.ShowToday&&(a.showDays=!1)),setTimeout(u,n)},i=function(){console.log("Failed to get week weather data, trying again..."),setTimeout(c,2e3)},g=function(){console.log("Failed to get curr weather data, trying again..."),setTimeout(u,2e3)},c=function(){console.log("week_refresh"),e.getWeatherData(a.app.Data,r,i)},u=function(){console.log("now_data"),e.getCurrentWeatherData(a.app.Data,o,g)},s=function(){var e=parseInt(a.app.Data.Items);a.lineLength=1>=e?0:70*e,1==a.app.Data.ShowToday?u():2==a.app.Data.ShowToday?c():(u(),c(),a.lineLength+=140)};a.weatherImg=function(a){return e.getImgOfWeather(a)},a.day=function(a){return e.getDay(a)};setInterval(s,108e6);a.update.func=function(e){if(e.Data!==JSON.stringify(a.app.Data)&&e.Data){var t=JSON.parse(e.Data);a.app.Data=t,s()}},s()}])}(),function(){angular.module("mirrorApp").factory("weatherService",["$http","dataService",function(a,e){var t={},n={};return t.getWeatherData=function(a,t,n){e.getData("http://api.openweathermap.org/data/2.5/forecast/daily?q="+a.Location+"&cnt="+a.Items+"&units=metric&mode=json&APPID=c7d757dcd68f0c72d6c80b8f680adca7",t,n)},t.getCurrentWeatherData=function(a,t,n){e.getData("http://api.openweathermap.org/data/2.5/weather?q="+a.Location+"&units=metric&mode=json&APPID=c7d757dcd68f0c72d6c80b8f680adca7",t,n)},t.getDay=function(a){if(0===a)return"Today";var e=(new Date).getDay(),t=e+a;return t>=n.dayMap.length&&(t=t-n.dayMap.length+1),n.dayMap[t]},t.getImgOfWeather=function(a){if(a)for(item in n.imgMap)if(n.imgMap[item].name==a.substr(0,2))return n.imgMap[item].img},t.getDay=function(a){if(0===a)return"Today";var e=(new Date).getDay(),t=e+a;return t>=n.dayMap.length&&(t-=n.dayMap.length),n.dayMap[t]},n.imgMap=[{name:"01",img:"clear.svg"},{name:"02",img:"few_clouds.svg"},{name:"03",img:"scattered_clouds.svg"},{name:"04",img:"broken_clouds.svg"},{name:"09",img:"shower_rain.svg"},{name:"10",img:"rain.svg"},{name:"11",img:"thunderstorm.svg"},{name:"13",img:"snow.svg"},{name:"50",img:"mist.svg"}],n.dayMap=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t}])}();